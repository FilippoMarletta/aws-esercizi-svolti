openapi: 3.0.1
info:
  title: MyApi to Lambda
  description: Simple Api
  version: 1.0.0
x-amazon-apigateway-request-validators:
  RequestModelPayload:
    validateRequestParameters: true
    validateRequestBody: true
paths:
  /writeToDB:
    post:
      summary: SendToLambda
      description: SendToLambda
      x-amazon-apigateway-request-validator: "RequestModelPayload"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InsertRequest"
      responses:
        "200":
          description: 200 response
      x-amazon-apigateway-integration:
        credentials:
          Fn::GetAtt: E05ApiGatewayLambdaRole.Arn
        uri:
          Fn::Sub: "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:E05LambdaFunction/invocations"
        responses:
          default:
            statusCode: "200"
        requestParameters:
          integration.request.header.Content-Type: "'application/x-www-form-urlencoded'"
        requestTemplates:
          application/json: Action=SendMessage&MessageBody=$util.escapeJavaScript($input.body).replaceAll("\\","")
        passthroughBehavior: never
        httpMethod: POST
        type: aws
components:
  schemas:
    InsertRequest:
      type: object
      required:
        - filmId
        - genere
        - title
      properties:
        filmId:
          type: integer
        genere:
          type: string
        title:
          type: string
      additionalProperties: false
